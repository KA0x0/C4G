#+TITLE: Guix System Configuration
#+PROPERTY: header-args:scheme :tangle wsl-config.scm

#+begin_src

(add-to-load-path (dirname (current-filename)))

(use-modules (gnu) (guix) (guix packages) (srfi srfi-1) (my-variables))
(use-service-modules mcron)
(use-package-modules certs)

(operating-system
  (host-name "wsl")
  (timezone "America/New_York")
  (locale "en_US.utf8")
  (kernel hello)
    (initrd (lambda* (. rest) (plain-file "dummyinitrd" "dummyinitrd")))
    (initrd-modules '())
    (firmware '())
  (bootloader
    (bootloader-configuration
      (bootloader
        (bootloader
          (name 'dummybootloader)
          (package hello)
          (configuration-file "/dev/null")
          (configuration-file-generator (lambda* (. rest) (computed-file "dummybootloader" #~(mkdir #$output))))
          (installer #~(const #t))))))
  (file-systems (list (file-system
                        (device "/dev/vda")
                        (mount-point "/")
                        (type "ext4")
                        (mount? #t))))
  (users (cons (user-account
                (name "kracken")
                (comment "Kracking hashes")
                (group "users")
                (supplementary-groups '("wheel")))
               %base-user-accounts))
  (packages
    (append
      (list
      xf86-video-amdgpu
      sshfs
      )
  my-packages))
  (services
    (append
      (list (service login-service-type my-motd)
            (service network-manager-service-type)
            (service openssh-service-type)
            (service unattended-upgrade-service-type)
      %base-services))))

#+end_src